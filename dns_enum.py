import dns.zone as dz
import dns.query as dq
import dns.resolver as dr
import click

NS = dr.Resolver()
Subdomains = []
NS.nameservers = ['ns1.inlanefreight.com', 'ns2.inlanefreight.com']

def AXFR(domain, nameserver):
    try:
        axfr = dz.from_xfr(dq.xfr(nameserver, domain))
        if axfr:
            print(f'[*] Successful Zone Transfer from: {nameserver}')
            for record in axfr:
                Subdomains.append(f'{record.to_text()}, {domain}')
        else:
            pass

    except Exception as error:
        print(error)
        pass


@click.command
@click.option('-d', '--domain', prompt="Domain name: ", help="List the domain name")
# @click.option('-n', '--nameservers', prompt="Nameservers: ", help="List the nameservers")
def main(domain, nameservers):
    Domain = domain
    nameservers = NS.nameservers

    for nameserver in nameservers:
        AXFR(Domain, nameserver)

        if Subdomains != None:
            print('---------Found Subdomains:')

            for subdomain in Subdomains:
                print(f'{subdomain}')

        else:
            print('No subdomains found.')
            exit()


if __name__=="__main__":
    main()
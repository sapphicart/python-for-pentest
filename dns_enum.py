import dns.zone as dz
import dns.query as dq
import dns.resolver as dr
import click

Subdomains = []

def AXFR(domain, nameserver):
    try:
        axfr = dz.from_xfr(dq.xfr(nameserver, domain))
        if axfr:
            print(f'[*] Successful Zone Transfer from: {nameserver}')
            for record in axfr:
                Subdomains.append('{}.{}'.format(record.to_text(), domain))
        else:
            pass

    except Exception as error:
        print(error)
        pass


@click.command
@click.option('-d', '--domain', prompt="Domain name: ", help="List the domain name")
@click.option('-n', '--nameservers', prompt="Nameservers: ", help="List the nameservers")
def main(domain, nameservers):
    NS = dr.Resolver()

    Domain = domain

    NS.nameservers = []
    for nameserver in nameservers:
        NS.nameservers.append(nameserver)
        AXFR(Domain, nameserver)

        if Subdomains != None:
            print('---------Found Subdomains:')

            for subdomain in Subdomains:
                print('{}'.format(subdomain))

        else:
            print('No subdomains found.')
            exit()


if __name__=="__main__":
    main()